\begin{tikzpicture}[
    node distance=2cm, 
    every node/.style={font=\sffamily\small},
    user/.style={circle, draw=black!70, fill=gray!10, thick, minimum size=1.2cm, align=center},
    segment/.style={rectangle, draw=black!60, fill=white, dashed, minimum width=2.5cm, minimum height=3cm, rounded corners},
    context/.style={regular polygon, regular polygon sides=6, draw=teal, fill=teal!10, thick, minimum size=1.2cm, align=center},
    offer/.style={rectangle, draw=black, fill=black!80, text=white, rounded corners, minimum width=2.5cm, minimum height=1cm, align=center},
    arrow/.style={->, >=stealth, thick, color=black!70}
]

% Panel A: Segmentation (Left)
\node[label=above:\textbf{A. Segmentation (Static)}] (labelA) at (0, 4.5) {};

\node[user] (user1) at (0, 0) {User A};
\node[user] (user2) at (-1, -1.5) {User B};
\node[user] (user3) at (1, -1.5) {User C};

% Group Box (Background)
\begin{scope}[on background layer]
    \node[segment, fit=(user1) (user2) (user3), label=below:\texttt{Demographic Group}] (group) {};
\end{scope}

% Offer
\node[offer, above=1.5cm of user1] (offerA) {Offer:\\Generic Coupon};
\draw[arrow] (offerA) -- (group);

% Panel B: Hyper-Personalization (Right)
\node[label=above:\textbf{B. Hyper-Personalization (Dynamic)}] (labelB) at (8, 4.5) {};

\node[user] (userH) at (8, 0) {User A};

% Context Nodes (Adjusted spacing)
\node[context, above left=1.0cm of userH] (ctx1) {Snowing\\(Weather)};
\node[context, above right=1.0cm of userH] (ctx2) {Search:\\Waterproof};
\node[context, below=1.2cm of userH] (ctx3) {Location:\\Ski Resort};

% Ontology Connections
\draw[dashed, color=teal] (ctx1) -- (userH);
\draw[dashed, color=teal] (ctx2) -- (userH);
\draw[dashed, color=teal] (ctx3) -- (userH);

% Perfect Offer
\node[offer, right=2.0cm of userH, fill=teal, text=white] (offerH) {Perfect Offer:\\Waterproof Boots};

% Inference Arrow
\draw[arrow, ultra thick, teal] (userH) -- node[above, font=\footnotesize\bfseries]{Inference} (offerH);

% Separation Line
\draw[thick, dotted] (4, 4.5) -- (4, -3);

\end{tikzpicture}
